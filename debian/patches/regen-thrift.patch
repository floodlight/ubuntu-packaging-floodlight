--- a/build.xml
+++ b/build.xml
@@ -109,7 +109,7 @@
         <mkdir dir="${test-output}"/>
     </target>
 
-    <target name="compile" depends="init">
+    <target name="compile" depends="init,gen-thrift">
         <javac includeAntRuntime="false" 
 	       classpathref="classpath" 
 	       debug="true" 
